<!DOCTYPE html>
<html lang="en">

<head>
   <meta charset="UTF-8">
   <meta name="viewport" content="width=device-width, initial-scale=1.0">
   <title>Document</title>
   <script src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js'></script>
</head>

<body>
   <a href="javascript:;">啟動 Line</a>

   <script>
      function openClient(scheme_url, download_url, timeout = 600) {
         var startTime = Date.now();
         var ifr = document.createElement('iframe');

         ifr.src = scheme_url;
         ifr.style.display = 'none';
         document.body.appendChild(ifr);

         var t = setTimeout(function () {
            var endTime = Date.now();

            if (!startTime || endTime - startTime < timeout + 200) {
               //App is not installed
               if (confirm("Application is not installed, go to the download?")) {
                  window.open(download_url, "_blank");
               }
            }
         }, timeout);

         window.onblur = function () {
            clearTimeout(t);
            window.addEventListener("DOMContentLoaded", function () {
               document.body.removeChild(ifr);
            }, false);
         }
      }

      $('a').on('click', function() {
         openClient('line://', 'https://line.me/', '600');
      });

   </script>
</body>

</html>