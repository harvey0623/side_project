<!DOCTYPE html>
<html>

<head>
	<meta http-equiv="Content-Type" content="text/html:charset=UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE-edge">
	<meta name="viewport" content="width=992,initial-scale=1.0">
	<link rel="icon" href="img/favicon.ico">
	<title>團購詳情方案</title>
	<link rel="stylesheet" href="../dist/css/bootstrap.min.css">
	<link rel="stylesheet" type="text/css" href="../dist/package/fontAwesome/css/all.css">
	<link rel="stylesheet" type="text/css" href="../dist/package/slick/slick.css">
	<link rel="stylesheet" type="text/css" href="../dist/package/slick/slick-theme.css">
	<link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.12/css/select2.min.css'/>
	<link rel="stylesheet" href="">
	<link rel="stylesheet" href="../dist/css/theme.css">
	<link rel="stylesheet" href="./css/groupByDetail.css">
	<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.0/jquery.min.js"></script>
	<script src="../dist/js/bootstrap.js"></script>
	<script src="../dist/package/slick/slick.min.js"></script>
	<script src='https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.12/js/select2.min.js'></script>
	<script src="../dist/js/axios.min.js"></script>
	<script src="../dist/js/theme.js"></script>
	
</head>

<body>
	<!-- 導航欄區塊 -->
	<header>
		<nav class="navbar navbar-default navbar-fixed-top">
			<div class="navbar-header">
				<button type="button" class="navbar-toggle collapsed" data-toggle="collapse"
					data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
					<span class="sr-only">Toggle navigation</span>
					<span class="icon-bar"></span>
					<span class="icon-bar"></span>
					<span class="icon-bar"></span>
				</button>
				<a class="navbar-brand" href="index.html">
					<img src="img/logo.svg" alt="">
				</a>
				<div class="icon-region shopcartIcon">
					<button type="button" class="member-btn">
						<div class="changeIcon">
							<i class="fal fa-shopping-cart"></i></div>
						<div class="num-box"><span>99+</span>
						</div>
					</button>
				</div>
			</div>
			<div class="collapse navbar-collapse" id="clamp1015bs-example-navbar-collapse-1">
				<ul class="nav navbar-nav navbar-right">
					<!-- 置頂圖片 -->
					<li class="icon-region imgRegion">
						<img src="img/menu_bg_img.jpg" alt="">
					</li>
					<li>
						<a href="#">店內餐飲</a>
					</li>
					<li class="dropdown iconRotate">
						<a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true"
							aria-expanded="false">商品介紹
							<span class="">
								<i class="fal fa-angle-down"></i>
							</span>
							<span class="none">
								<i class="fal fa-angle-up"></i>
							</span>
						</a>
						<ul class="dropdown-menu">
							<li><a href="#">咖啡</a></li>
							<li><a href="#">咖啡器具</a></li>
							<li><a href="#">優惠禮盒組</a></li>
							<li><a href="#">訂購固定配送</a></li>
						</ul>
					</li>
					<li>
						<a href="articleList.html">最新消息</a>
					</li>
					<li>
						<a href="#">門市資訊</a>
					</li>
					<li class="dropdown iconRotate">
						<a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true"
							aria-expanded="false">品牌資訊
							<span class="">
								<i class="fal fa-angle-down"></i>
							</span>
							<span class="none">
								<i class="fal fa-angle-up"></i>
							</span>
						</a>
						<ul class="dropdown-menu">
							<li><a href="#">關於 cama</a></li>
							<li><a href="#">媒體報導</a></li>
							<li><a href="#">cama 大事記</a></li>
						</ul>
					</li>
					<li>
						<a href="coffeeTalk.html">談咖啡</a>
					</li>
					<li class="dropdown iconRotate">
						<a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true"
							aria-expanded="false">聯絡我們
							<span class="">
								<i class="fal fa-angle-down"></i>
							</span>
							<span class="none">
								<i class="fal fa-angle-up"></i>
							</span>
						</a>
						<ul class="dropdown-menu">
							<li><a href="#">填寫表單</a></li>
							<li><a href="#">人才招募</a></li>
							<li><a href="#">我要加盟</a></li>
							<li><a href="#">部落格</a></li>
						</ul>
					</li>
					<!-- 購物車icon -->
					<li class="icon-region shopcartIcon">
						<button type="button" class="member-btn">
							<div class="changeIcon">
								<i class="fal fa-shopping-cart"></i></div>
							<div class="num-box"><span>99+</span>
							</div>
						</button>
					</li>
					<!-- 會員中心icon 未登入 -->
					<li class="icon-region none">
						<div class="member-box web">
							<button type="button" class="member-btn">
								<img src="img/user.svg" alt="">
							</button>
						</div>
						<div class="member-box mobile">
							<a href="#">登入/註冊</a>
						</div>
					</li>
					<!-- 會員中心icon 登入 -->
					<li class="icon-region">
						<div class="member-box dropdown iconRotate web">
							<button type="button" class="dropdown-toggle member-btn" data-toggle="dropdown" role="button"
								aria-haspopup="true" aria-expanded="false">
								<img src="img/user_hover.svg" alt="">
							</button>
							<ul class="dropdown-menu">
								<li><a href="#">會員資料</a></li>
								<li><a href="#">我的點數</a></li>
								<li><a href="#">訂單管理</a></li>
								<li><a href="#">登出</a></li>
							</ul>
						</div>
						<div class="member-box dropdown iconRotate mobile">
							<a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true"
								aria-expanded="false">會員中心
								<span class="">
									<i class="fal fa-angle-down"></i>
								</span>
								<span class="none">
									<i class="fal fa-angle-up"></i>
								</span>
							</a>
							<ul class="dropdown-menu">
								<li><a href="#">會員資料</a></li>
								<li><a href="#">我的點數</a></li>
								<li><a href="#">訂單管理</a></li>
								<li><a href="#">登出</a></li>
							</ul>
						</div>
					</li>
				</ul>
			</div>
		</nav>
	</header>

	<!-- 浮動側邊欄 -->
	<menu>
		<ul class="floatMenu">
			<li class="goTop">
				<a href="javascript:;"><i class="fal fa-angle-double-up"></i></a>
			</li>
		</ul>
	</menu>

	<!-- 內容區塊 -->
	<div class="content">
		<!--麵包籤 -->
		<div class="breadcrumb-region">
			<div class="container">
				<ol class="breadcrumb">
					<li><a href="index.html">首頁</a></li>
					<li><a href="prod_list.html">訂閱制</a></li>
					<li><a href="prod_list.html">團體方案</a></li>
					<li><a class="active" href="prod_list.html">商品名稱</a></li>
				</ol>
			</div>
		</div>
		<!-- 區塊／側欄區／01-左側欄 -->
		<div>
			<div class="container">
				<h1 class="productName">這是商品標題</h1>

				<div class="detailWrap">
					<div class="detailL">
						<div class="slickTop">
							<div>
								<img src="https://fakeimg.pl/300x300/?text=item1">
							</div>
							<div>
								<img src="https://fakeimg.pl/300x300/?text=item2">
							</div>
							<div>
								<img src="https://fakeimg.pl/300x300/?text=item3">
							</div>
							<div>
								<img src="https://fakeimg.pl/300x300/?text=item4">
							</div>
						</div>
						<div class="slick-nav">
							<div>
								<img src="https://fakeimg.pl/300x300/?text=item1">
							</div>
							<div>
								<img src="https://fakeimg.pl/300x300/?text=item2">
							</div>
							<div>
								<img src="https://fakeimg.pl/300x300/?text=item3">
							</div>
							<div>
								<img src="https://fakeimg.pl/300x300/?text=item4">
							</div>
						</div>
					</div>
					<div class="detailR">
						<!-- 商品描述 -->
						<div class="descBox" id="descBox">
							<!-- <div class="descRow">
								<div class="descL">
									<i class="fas fa-circle"></i>
								</div>
								<div class="descR">規格1: 123654789</div>
							</div> -->
						</div>

						<!-- 商品規格 -->
						<div class="infoBox">
							<div class="infoRow" id="formatRow">
								<div class="infoTitle">規格</div>
								<div class="infoBody" id="formatBox">
									<!-- <div class="typeBox">1/4磅</div> -->
								</div>
							</div>
							<div class="infoRow" id="periodRow">
								<div class="infoTitle">期數</div>
								<div class="infoBody" id="periodBox">
									<!-- <div class="typeBox">3期</div> -->
								</div>
							</div>
							<div class="infoRow">
								<div class="infoTitle packageTitle">包數</div>
								<div class="infoBody packageBox">
									<select class="packageNumber"></select>
									<span class="packageTip">※挑選相應包數咖啡豆</span>
								</div>
							</div>
							<div class="infoRow" id="flavorRow">
								<div class="infoTitle flavorTitle">風味</div>
								<div class="infoBody flavorBox">
									<div class="flavorInner">
										<select class="flavorType" id="basicType"></select>
										<select class="flavorNumbr" id="basicNumber"></select>
										<div class="addItem">
											<i class="far fa-plus"></i>
										</div>
									</div>
								</div>
							</div>
						</div>

						<!-- 計算金額 -->
						<div class="calculateBox">
							<div class="moneyInfo">
								<button id="calculate" class="orange-btn">試算金額</button>
								<p class="specialPrice">優惠價 <span>0</span>元</p>
							</div>
							<div class="settleBox">
								<button class="white-btn">加到購物車</button>
								<button class="orange-btn">直接購買</button>
							</div>
						</div>

						<!-- 售完 -->
						<div class="soldOutBox">已售完</div>

					</div>
				
				</div>
				
				<!-- 圖文編輯 -->
				<div class="categoryEditBox">
					<p>圖文編輯</p>
				</div>

				<!-- 好咖推薦 -->
				<div class="recommend">
					<h3>好咖推薦</h3>
					<div class="recommend-item">
						<div class="recommend-slick">
							<div>
								<a href="javascript:;">
									<img src="https://fakeimg.pl/300x300/?text=item1">
									<p class="recommend-text">
										商品描述商品描述商品描述商品描述商品描
										商品描述商品描述商品描述商品描述商品描商品描述商品描述商品描述商品描述商品描
									</p>
								</a>
							</div>
							<div>
								<a href="javascript:;">
									<img src="https://fakeimg.pl/300x300/?text=item1">
									<p class="recommend-text">
										商品描述商品描述商品描述商品描述商品描
										商品描述商品描述商品描述商品描述商品描商品描述商品描述商品描述商品描述商品描
									</p>
								</a>
							</div>
							<div>
								<a href="javascript:;">
									<img src="https://fakeimg.pl/300x300/?text=item1">
									<p class="recommend-text">
										商品描述商品描述商品描述商品描述商品描
										商品描述商品描述商品描述商品描述商品描商品描述商品描述商品描述商品描述商品描
									</p>
								</a>
							</div>
							<div>
								<a href="javascript:;">
									<img src="https://fakeimg.pl/300x300/?text=item1">
									<p class="recommend-text">
										商品描述商品描述商品描述商品描述商品描
										商品描述商品描述商品描述商品描述商品描商品描述商品描述商品描述商品描述商品描
									</p>
								</a>
							</div>
						</div>
						<div class="arrowBox arrowL">
							<i class="fal fa-chevron-left"></i>
						</div>
						<div class="arrowBox arrowR">
							<i class="fal fa-chevron-right"></i>
						</div>
					</div>
				</div>

			</div>
		</div>
	</div>

	<!-- footer-->
	<footer>
		<div class="footer-region">
			<div class="container">
				<div class="logo-box">
					<img src="img/footer_logo.png" alt="">
				</div>
				<div class="contact-region">
					<ul>
						<li class="title">總公司</li>
						<li><i class="fas fa-map-marker-alt"></i>台北市大安區安和路一段 27 號 18 樓</li>
						<li><i class="fas fa-phone" data-fa-transform="flip-h"></i>(02) 2775 - 3385</li>
						<li><i class="far fa-envelope"></i>service@camacafe.com</li>
					</ul>
					<ul>
						<li class="title"></li>
						<li><a href="product_list.html">商品介紹</a></li>
						<li><a href="menu_drink.html">店內飲品</a></li>
						<li><a href="store_location.html">門市查詢</a></li>
					</ul>
					<ul>
						<li class="title"></li>
						<li><a href="#">關於cama</a></li>
						<li><a href="faqs.html">常見問題</a></li>
						<li><a href="terms.html">隱私權條款</a></li>
					</ul>
					<ul>
						<li class="title"></li>
						<li><a href="#">夥伴登入</a></li>
						<li><a href="#">人才招募</a></li>
						<li><a href="contact.html">聯絡我們</a></li>
					</ul>
				</div>
			</div>
		</div>
		<div class="copyright-region">
			<div class="container">
				<div class="text">
					Copyright © cama café 版權所有. All rights reserved.
				</div>
				<div class="shareRegion">
					<button type="button" class="facebookIcon">
						<i class="fab fa-facebook-square"></i>
					</button>
					<button type="button" class="lineIcon">
						<i class="fab fa-line"></i>
					</button>
					<button type="button" class="instagramIcon">
						<i class="fab fa-instagram"></i>
					</button>
				</div>
			</div>
		</div>
	</footer>
	
	<script src="./js/groupByDetail.js"></script>
	<script src="./js/modules/dataSchema.js"></script>
	<script type="module">
		import FormatController from './js/modules/formatController.js';
		import PeriodController from './js/modules/periodController.js';
		import CountController from './js/modules/countController.js';
		import DescController from './js/modules/descController.js';
		import Calculate from './js/modules/calculate.js';
		alert('aaaaa');
		try {
			let { iType, period, formatArr, spec } = dataSchema;
		} catch (err) {
			alert(err);
		}
		alert(JSON.stringify(dataSchema))
		let packageMaxNumber = dataSchema.vProductBuyTotal;
		let description = dataSchema.info.vProductSummary;
		let specData = spec.reduce(( prev, current ) => {
			prev.push({ 
				id: current.iId, 
				title: current.vSpecTitle,
				stock: current.iSpecStock
			});
			return prev;
		}, []);

		let info = { 
			formatId: '',
			periodId: '',
			packageMaxNumber: 1,
			groupType: iType
		};

		let infoProxy = new Proxy(info, {
			get(target, key) {
				return target[key];
			},
			set(target, key, payload) {
				if (key === 'formatId') {
					if (payload !== null) {
						let flavorData = spec.find(item => item.iId === payload)['spec_product'];
						countController.setFlavorData = flavorData;
					} else {
						countController.setFlavorData = [];
					}			
				}
				target[key] = payload;
				return true;
			}
		});

		let formatController = new FormatController({
			formatRowEl: '#formatRow',
			formatBoxEl: '#formatBox',
			formatData: specData,
			groupType: infoProxy.groupType,
			changeEvent(id) {
				infoProxy.formatId = id;
			},
			emptyEvent() {
				infoProxy.formatId = null;
			}
		});
		
		let countController = new CountController({
			flavorBoxEl: '.flavorBox',
			flavorRowEl: '#flavorRow',
			packageEl: '.packageNumber',
			basicTypeEl: '#basicType',
			basicNumberEl: '#basicNumber',
			addItemEl: '.addItem',
			packageMaxNumber: packageMaxNumber,
			packageNumberEvent(count) {
				infoProxy.packageMaxNumber = count;
			}
		});

		let periodController = new PeriodController({
			periodRowEl: '#periodRow',
			periodBoxEl: '#periodBox',
			periodData: period,
			changeEvent(id) {
				infoProxy.periodId = id;
			}
		});

		let descController = new DescController({
			descBoxEl: '#descBox',
			descData: description
		});

		let calculate = new Calculate({
			calculateEl: '#calculate',
			specialEl: '.specialPrice > span',
			infoData: infoProxy,
			countInstance: countController,
		});

		formatController.init();

		//===讀取user資料
		// infoProxy.groupType = readSchema.type;
		// infoProxy.formatId = readSchema.formatId;
		// infoProxy.periodId = readSchema.periodId;
		// infoProxy.packageMaxNumber = readSchema.maxPackage;
		// formatController.setFormatId({
		// 	id: infoProxy.formatId,
		// 	type: infoProxy.groupType
		// });
		// periodController.setPeriodId(infoProxy.periodId);
		// countController.setPackageNumber(infoProxy.packageMaxNumber);
		// countController.setBasicTypeAndNumber(readSchema.products[0]);
		// let otherProduct = readSchema.products.slice(1);
		// if (otherProduct.length !== 0) {
		// 	otherProduct.forEach(item => {
		// 		countController.addItemHandler(item);
		// 	});
		// }
		
		//試算功能
		$('#calculate').on('click', function() {
			if (infoProxy.groupType === 1) {
				let { status, userData } = calculate.reachedLimit();
				if (status) {
					console.log(infoProxy);
					console.log(userData);
				} else {
					alert('選擇包數不正確');
				}
			} else if (infoProxy.groupType === 2) {
				console.log(infoProxy);
			}
		});

	</script>
</body>



</html>