<!DOCTYPE html>
<html lang="en">
   <head>
      <meta charset="UTF-8" />
      <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <meta http-equiv="X-UA-Compatible" content="ie=edge" />
      <title>Document</title>
      <script src="https://static.line-scdn.net/liff/edge/2.1/sdk.js"></script>
   </head>

   <body>
      <p>liff-app</p>
      <button class="btnLogin">login</button>
      <button class="btnScan">scan</button>

      <script>
         let btnLogin = document.querySelector('.btnLogin');
         let btnScan = document.querySelector('.btnScan');

         function initializeApp() {
            if (!liff.isLoggedIn()) {
               alert('not login');
               liff.login({ redirectUri: 'https://harvey0623.github.io/side_project/liff/' });
            } else {
               liff.getProfile().then(profile => {
                  console.log(profile);
               });
            }
         }

         function scanHandler() {
            if (!liff.isInClient()) {
               alert('請使用line-app瀏覽器');
            } else {
               if (liff.scanCode) {
                  liff.scanCode().then(result => {
                     // e.g. result = { value: "Hello LIFF app!" }
                     let scanResult = JSON.stringify(result);
                     alert(scanResult);
                  }).catch(err => {
                     alert('scanCode failed');
                  });
               }
            }
         }

         function initializeLiff(myLiffId) {
            liff.init({
                  liffId: '1653839303-x2RKROGO'
               }).then(() => {
                  btnLogin.addEventListener('click', initializeApp);
                  btnScan.addEventListener('click', scanHandler);
               }).catch(err => {
                  alert(err.message)
               });
         }


         initializeLiff()
      </script>
   </body>
</html>
