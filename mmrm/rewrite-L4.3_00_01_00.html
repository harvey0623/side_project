<!DOCTYPE html>
<html lang="en">

<head>
	<title>最新消息</title>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta http-equiv="X-UA-Compatible" content="ie=edge">
	<meta name="aes_key" content="791701991223a6d7193e964b6690b58a">
	<link rel="icon" href="" type="image/jpg" sizes="16x16">
	<link rel="stylesheet" href="./lib/fontIcon/css/all.min.css">
	<link rel='stylesheet' href='./lib/bs4/bootstrap.min.css'/>
	<link rel="stylesheet" href="./css/main.css">
	<link rel="stylesheet" href="./css/rewrite-L4.3_00_01_00.css">
	<script src='./lib/jquery/jquery.min.js'></script>
	<script src='./lib/bs4/bootstrap.bundle.min.js'></script>
	<script src='./lib/vue/vue.js'></script>
	<script src="./lib/vue/vee-validate.js"></script>
	<script src="./lib/axios/axios.min.js"></script>
	<script src="./lib/sprintf/sprintf.js"></script>
	<script src="./lib/crypto/crypto-js.min.js"></script>
	<script src="./js/src/setColor.js"></script>
</head>

<body>
	<div id="app" v-cloak>
		<div class="newsFilterBox">
			<div class="controlPanel">
				<div class="layoutBox">
					<span 
						v-for="layout in layoutList"
						:key="layout.id"
						:class="['layout', layout.class, { active: layoutId === layout.id }]"
						@click="layoutHandler(layout.id)"
					></span>
				</div>
				<div class="text" @click="openHandler">篩選</div>
			</div>
		</div>
		<div class="mycontainer">
			<ul class="newsBox">
				<news-item
					v-for="(news,index) in newsList"
					:key="index"
					:news="news"
					:changelayout="changeLayout"
					:newsorder="newsOrder"
					:index="index"
					:multiplebrand="isMultipleBrand"
					@popup="showPopup"
				></news-item>
			</ul>
			<div class="emptyBlock" v-show="hasEmpty">
				<div class="emptyBg"></div>
				<p>目前沒有最新消息呦！</p>
			</div>
			<div class="pagTip" v-show="reachBottom">已經到最底瞜~</div>
		</div>

		<!-- 側邊選單 -->
		<news-sidebar
			:turnon.sync="turnOn"
			:layoutid="layoutId"
			:apiurl="apiUrl"
			:multiplebrand="isMultipleBrand"
			ref="sidebar"
			@switchlayout="layoutHandler"
			@search="searchHandler"
		></news-sidebar>

		<transition name="fade">
			<div id="maskCover" v-if="turnOn"></div>
		</transition>

		<!-- loading畫面 -->
		<div id="loading" v-show="searchLoading"></div>

		<!-- 外部連結提示modal -->
		<div class="modal msgModal" id="hyperModal" data-backdrop="static">
			<div class="modal-dialog modal-dialog-centered">
				<div class="modal-content">
					<div class="modal-header">
						<h1 class="modal-title">提示</h1>
					</div>
					<div class="modal-body">
						<p>{{ modalTitle.hyperlink }}</p>
					</div>
					<div class="modal-footer split">
						<div onclick="$('#hyperModal').modal('hide')">取消</div>
						<div @click="confirmHyper">確定</div>
					</div>
				</div>
			</div>
		</div>

		<!-- 密碼驗證modal -->
		<div class="modal inputModal" id="checkPw" data-backdrop="static">
			<div class="modal-dialog modal-dialog-centered">
				<div class="modal-content">
					<div class="modal-header">
						<h1 class="modal-title">提示</h1>
					</div>
					<validation-observer tag="div" class="modal-body" ref="form">
						<div class="tipText">本連結需使用到您的個人資料，請先輸入會員密碼</div>
						<validation-provider
							tag="div" class="inputBox" 
							rules="required|password"
							v-slot="{ errors }">
							<input 
								type="password" 
								class="form-control" 
								placeholder="請輸入會員密碼"
								maxLength="12"
								v-model.trim="user.password">
							<p class="errMsg" v-show="errors.length !== 0">{{ errors[0] }}</p>
						</validation-provider>
					</validation-observer>
					<div class="modal-footer">
						<div onclick="$('#checkPw').modal('hide')">取消</div>
						<div @click="confirmPassword">確定</div>
					</div>
				</div>
			</div>
		</div>

		<!-- 錯誤提示 -->
		<div class="modal msgModal" id="failModal" data-backdrop="static">
			<div class="modal-dialog modal-dialog-centered">
				<div class="modal-content">
					<div class="modal-header">
						<h1 class="modal-title">提示</h1>
					</div>
					<div class="modal-body">
						<p>{{ modalTitle.error }}</p>
					</div>
					<div class="modal-footer">
						<p onclick="$('#failModal').modal('hide')">確認</p>
					</div>
				</div>
			</div>
		</div>

		<!-- 選單modal -->
		<div class="modal optionModal" id="optionModal" data-backdrop="static">
			<div class="modal-dialog modal-dialog-centered">
				<div class="modal-content">
					<div class="modal-header">
						<h1 class="modal-title">{{ modalTitle.popup }}</h1>
					</div>
					<div class="modal-body">
						<div
							class="couponItem cancelColor"
							v-for="(option,index) in optionList"
							:key="index"
							@click="optionClick(option)">
							{{ option.title }}
						</div>
						<div class="couponItem">
							<p onclick="$('#optionModal').modal('hide')">取消</p>
						</div>
					</div>
				</div>
			</div>
		</div>

	</div>

	<script src="./js/src/systemLang.js"></script>
	<script src="./js/src/globalEncrypt.js"></script>
	<script src="./js/vue-components/veevalidate.js"></script>
	<script src="./js/src/vue-mixin/openLink.js"></script>
	<script src="./js/vue-components/NewSidebar/index.js"></script>
	<script src="./js/vue-components/NewsItem/index.js"></script>
	<script type="module">
		import app from './js/page/L4/rewrite-L4.3_00_01_00.js';
		app({
			openLink: window.openLink,
			apiUrl: {
				searchBrand: 'http://localhost:3034/mmrmProd/search_brand',
            brandInfo: 'http://localhost:3034/mmrmProd/brand_information',
            categoryList: 'http://localhost:3034/mmrmProd/cms_list_category_information',
            searchList: 'http://localhost:3034/mmrmProd/search_cms_list_item',
				brandInfo: 'http://localhost:3034/mmrmProd/brand_information',
				verifyPassword: 'http://localhost:3034/mmrmProd/verify_password',
				multipleBrand: 'http://localhost:3034/mmrmProd/multiple_brand'
			},
			pageUrl: {
				book: './rewrite-L4.3_00_02_00.html',
         }
		});
	</script>
</body>

</html>